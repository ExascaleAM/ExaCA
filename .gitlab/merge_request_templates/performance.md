**1. Purpose of this MR**



**2. Necessary checks before merging**

- [ ] Clang-format applied (should be squashed)
- [ ] Compilation and correctness check on CPU
- [ ] Compilation and correctness check	on Cuda
- [ ] Compilation and correctness check	on HIP
- [ ] Performance check on CPU
- [ ] Performance check	on Cuda
- [ ] Performance check	on HIP


**3. Issue this MR fixes or is related to (optional)**


